<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Multi-Chronometer App</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #fff;
    margin: 20px;
  }
  #addChronoBtn {
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    background-color: #007BFF;
    color: #fff;
    border: none;
    border-radius: 5px;
    transition: background-color 0.3s ease;
  }
  #addChronoBtn:hover {
    background-color: #0056b3;
  }
  .chronometer {
    padding: 10px 0;
    margin: 0;
    display: flex;
    align-items: center;
    background-color: transparent;
    transition: background-color 0.3s ease;
  }
  .chronometer input[type="text"] {
    font-size: 18px;
    width: 150px;
    border: none;
    background: transparent;
    outline: none;
    color: #333;
  }
  .time-display {
    font-size: 24px;
    margin: 0 20px;
    flex-grow: 1;
    color: #333;
    font-variant-numeric: tabular-nums;
  }
  .chronometer button {
    background: none;
    border: none;
    cursor: pointer;
    padding: 5px;
    outline: none;
    margin-left: 10px;
    transition: transform 0.2s ease;
  }
  .chronometer button:hover {
    transform: scale(1.1);
  }
  #chronometers {
    margin-top: 20px;
  }
</style>
</head>
<body>

<h1>Multi-Chronometer App</h1>
<button id="addChronoBtn">Add New Chronometer</button>
<div id="chronometers"></div>

<script>
  var chronometerCount = 0;
  var chronometers = {};
  var maxChronometers = 10;

  // Define the lightest and darkest colors in RGB
  var lightestColor = { r: 0xcc, g: 0xf9, b: 0xff }; // #ccf9ff
  var darkestColor = { r: 0x00, g: 0x80, b: 0xbf }; // #0080bf

  function addChronometer() {
    chronometerCount++;
    var chronoId = 'chrono' + chronometerCount;
    var chronometerDiv = document.createElement('div');
    chronometerDiv.className = 'chronometer';
    chronometerDiv.id = chronoId;

    // Calculate the background color based on the inverted chronometer count
    var ratio = (chronometerCount - 1) / (maxChronometers - 1);
    var r = Math.round(lightestColor.r + (darkestColor.r - lightestColor.r) * ratio);
    var g = Math.round(lightestColor.g + (darkestColor.g - lightestColor.g) * ratio);
    var b = Math.round(lightestColor.b + (darkestColor.b - lightestColor.b) * ratio);
    chronometerDiv.style.backgroundColor = 'rgb(' + r + ', ' + g + ', ' + b + ')';

    var input = document.createElement('input');
    input.type = 'text';
    input.placeholder = 'Chronometer Name';

    var timeDisplay = document.createElement('div');
    timeDisplay.className = 'time-display';
    timeDisplay.textContent = '00:00:00.000';

    // Control Buttons with Icons
    var startBtn = document.createElement('button');
    startBtn.innerHTML = '&#9658;'; // Play icon
    startBtn.title = 'Start';
    startBtn.onclick = function() { startChrono(chronoId); };

    var pauseBtn = document.createElement('button');
    pauseBtn.innerHTML = '&#10074;&#10074;'; // Pause icon
    pauseBtn.title = 'Pause';
    pauseBtn.onclick = function() { pauseChrono(chronoId); };

    var stopBtn = document.createElement('button');
    stopBtn.innerHTML = '&#9724;'; // Stop icon
    stopBtn.title = 'Stop';
    stopBtn.onclick = function() { stopChrono(chronoId); };

    var resetBtn = document.createElement('button');
    resetBtn.innerHTML = '&#8635;'; // Reset icon
    resetBtn.title = 'Reset';
    resetBtn.onclick = function() { resetChrono(chronoId); };

    chronometerDiv.appendChild(input);
    chronometerDiv.appendChild(timeDisplay);
    chronometerDiv.appendChild(startBtn);
    chronometerDiv.appendChild(pauseBtn);
    chronometerDiv.appendChild(stopBtn);
    chronometerDiv.appendChild(resetBtn);

    document.getElementById('chronometers').appendChild(chronometerDiv);

    chronometers[chronoId] = {
      intervalId: null,
      startTime: null,
      elapsedTime: 0,
      running: false,
    };
  }

  function updateDisplay(chronoId) {
    var chrono = chronometers[chronoId];
    var now = Date.now();
    var diff = chrono.elapsedTime + (now - chrono.startTime);
    var timeDisplay = document.querySelector('#' + chronoId + ' .time-display');
    timeDisplay.textContent = formatTime(diff);
  }

  function formatTime(ms) {
    var totalSeconds = Math.floor(ms / 1000);
    var hrs = String(Math.floor(totalSeconds / 3600)).padStart(2, '0');
    var mins = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, '0');
    var secs = String(totalSeconds % 60).padStart(2, '0');
    var millis = String(ms % 1000).padStart(3, '0');
    return hrs + ':' + mins + ':' + secs + '.' + millis;
  }

  function startChrono(chronoId) {
    // Stop other chronometers
    for (var id in chronometers) {
      if (id !== chronoId && chronometers[id].running) {
        pauseChrono(id);
      }
    }

    var chrono = chronometers[chronoId];
    if (!chrono.running) {
      chrono.startTime = Date.now();
      updateDisplay(chronoId); // Update immediately
      chrono.intervalId = setInterval(function() { updateDisplay(chronoId); }, 50);
      chrono.running = true;
    }
  }

  function pauseChrono(chronoId) {
    var chrono = chronometers[chronoId];
    if (chrono.running) {
      clearInterval(chrono.intervalId);
      chrono.elapsedTime += Date.now() - chrono.startTime;
      chrono.running = false;
    }
  }

  function stopChrono(chronoId) {
    pauseChrono(chronoId);
    chronometers[chronoId].elapsedTime = 0;
    document.querySelector('#' + chronoId + ' .time-display').textContent = '00:00:00.000';
  }

  function resetChrono(chronoId) {
    stopChrono(chronoId);
    startChrono(chronoId);
  }

  document.getElementById('addChronoBtn').addEventListener('click', addChronometer);
</script>

</body>
</html>
